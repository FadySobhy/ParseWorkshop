<!DOCTYPE html>
<html lang="en" style="height:100%;" ng-app="Todo" ng-controller="logic">
<head>
    <meta charset="utf-8">
    <title>Your Todos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <!-- Style Library -->
    <link href="css/style-library-1.css" rel="stylesheet">
    <link href="css/plugins.css" rel="stylesheet">
    <link href="css/blocks.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements. All other JS at the end of file. -->
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <script src="js/angular.min.js"></script>
    <script src="js/angular-sanitize.js"></script>
    <script src="js/parse.min.js"></script>
    <script>
        Parse.initialize("myAppId");
        Parse.serverURL = 'https://docker19107-env-2854709.mircloud.host/parse';
        Parse.clientKey = 'myClientKey';

        if (!Parse.User.current()) {
            alert("You are not logged in.");
            window.location = "index.html";
        }

        angular.module("Todo", ['ngSanitize']).controller("logic", function ($scope) {
            $scope.tasks = [];
            $scope.loadAll = function () {
                var query = new Parse.Query(Parse.Object.extend("Task"));
                query.equalTo("user", Parse.User.current());
                query.find(
                        function (results) {
                            $scope.tasks = results;
                            $scope.$apply();

                        }
                );
            }
            $scope.addTask = function () {
                var task = new Parse.Object("Task");
                task.set("data", $scope.taskData);
                task.set("checked", false);
                task.set("user", Parse.User.current());
                task.save(null, {
                    success: function () {
                        $scope.loadAll();
                    },
                    error: function (obj, error) {
                        alert('Failed to create new object, with error code: ' + error.message);
                    }
                });
                $scope.taskData = "";
            }

            $scope.remove = function (parseObject) {
                parseObject.destroy();
                $scope.loadAll();
            }
            $scope.update = function (parseObject) {
                parseObject.set("checked", !parseObject.get("checked"));
                parseObject.save();
                $scope.loadAll();
            }

            $scope.logout = function () {
                Parse.User.logOut().then(function () {
                    alert("Bye.");
                    window.location = "index.html";
                });
            }

            $scope.loadAll();

        });

    </script>
</head>
<body data-spy="scroll" data-target="nav">
<a href="https://github.com/ahmedengu/ParseWorkshop">
    <img style="position: absolute; top: 0; left: 0; border: 0;z-index:9999;"
         src="https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67"
         alt="Fork me on GitHub"
         data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png">
</a>
<header id="header-1" class="soft-scroll header-1">
    <!-- Navbar -->
    <nav class="main-nav navbar-fixed-top headroom headroom--pinned">
        <div class="container">
            <!-- Brand and toggle -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="#">
                    <img src="images/brand/pgblocks-logo-white-nostrap.png" class="brand-img img-responsive">
                </a>
            </div>
            <!-- Navigation -->
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class="active nav-item">
                    </li>
                    <li class="nav-item">
                    </li>
                    <li class="nav-item">
                    </li>
                    <li class="nav-item dropdown">
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#">Dropdown 1</a>
                            </li>
                            <li>
                                <a href="#">Dropdown 2</a>
                            </li>
                            <li>
                                <a href="#">Dropdown 3</a>
                            </li>
                            <li>
                                <a href="#">Dropdown 4</a>
                            </li>
                        </ul>
                    </li>
                    <!--//dropdown-->
                    <li class="nav-item">
                        <button class="btn btn-danger btn-block" ng-click="logout()">Logout</button>
                    </li>
                </ul>
                <!--//nav-->
            </div>
            <!--// End Navigation -->
        </div>
        <!--// End Container -->
    </nav>
    <!--// End Navbar -->
</header>
<section id="promo-1" class="content-block promo-1 min-height-600px bg-offwhite">
    <div class="container well">
        <div class="row">
            <div class="col-md-offset-4 col-sm-offset-4 col-xs-offset-4 col-lg-offset-4">
                <h1>Your Todos:</h1>
            </div>
        </div>
        <!-- /.row -->
        <div class="row">
            <div class="col-md-offset-2 col-lg-offset-2 col-sm-offset-2 col-xs-offset-2">
                <label ng-repeat="task in tasks" ng-show="tasks.length" class="center-block ">
                    <input class="control-label" type="checkbox" ng-checked="task.get('checked')"
                           ng-click="update(task)">
                    <span ng-bind-html="task.get('data')"></span>
                    <a class="btn-link" ng-click="remove(task)">remove</a>
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-md-offset-5 col-sm-offset-5 col-xs-offset-5 col-lg-offset-5">
                <button type="button" class="btn btn-primary" data-target="#modal1" data-toggle="modal">Add</button>
            </div>
        </div>
    </div>
</section>
<section class="content-block-nopad bg-deepocean footer-wrap-1-1">
    <div class="container footer-1-1">
        <div class="row">
            <div class="col-sm-5">
                <img src="images/brand/pgblocks-logo-white.png" class="brand-img img-responsive">
                <h3>Over <strong>10,000</strong> downloads last month…</h3>
                <p class="lead">We've hand-crafted <strong>pgblocks</strong> in great detail to make your life easier…
                    enjoy!</p>
            </div>
            <div class="col-sm-6 col-sm-offset-1">
                <div class="row">
                    <div class="col-md-4">
                        <h4>Shortcuts</h4>
                        <ul>
                            <li>
                                <a href="#">About us</a>
                            </li>
                            <li>
                                <a href="#">Services</a>
                            </li>
                            <li>
                                <a href="#">Portfolio</a>
                            </li>
                            <li>
                                <a href="#">Blog</a>
                            </li>
                            <li>
                                <a href="#">Contact</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <h4>Legal Stuff</h4>
                        <ul>
                            <li>
                                <a href="#">Privacy Policy</a>
                            </li>
                            <li>
                                <a href="#">Terms & Conditions</a>
                            </li>
                            <li>
                                <a href="#">Cookie Policy</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <h4>Seen Enough?</h4>
                        <a href="#" class="btn btn-block btn-primary">Buy Now</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.row -->
    </div>
    <!-- /.container -->
</section>
<div class="modal fade pg-show-modal" id="modal1" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Add new task<br></h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="control-label" for="formInput142">Task
                        <br>
                    </label>
                    <input type="text" class="form-control" id="formInput142" placeholder="Task" ng-model="taskData">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" ng-click="addTask()" data-dismiss="modal">Add</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/plugins.js"></script>
<script type="text/javascript" src="js/bskit-scripts.js"></script>
</body>
</html>
